/*
Example implementing wide mouthed frog protocol
======================================

Author: 	Hugo Thevenin
Date: 	        June 2024

*/

theory WideMouthedFrog
begin

builtins : hashing, symmetric-encryption
functions: blabla/2

rule Server_1:
    [
        !Secretk($B, $S, kbs)
        ,!Secretk($A, $S, kas)
        ,In(<$A, senc(<' 1', Ta, $B, kab>,kas)>)
        ,Fr(~Ts)
    ]
  --[Server_send($A, $S, $B, kab)]->
    [
       Out(senc(<' 2', ~Ts, $A, kab>,kbs))
    ]
end